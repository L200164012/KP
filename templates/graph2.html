{% extends 'base.html' %}
{% load static %}
{% block title %}
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Bidang pekerjaan alumni</title>
	<style type="text/css">
        #container {
            min-width: 310px;
            max-width: 800px;
            height: 400px;
            margin: 0 auto
        }
		</style>

	<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
	<link rel="stylesheet" href="{% static 'jquery-loading-master/dist/jquery.loading.min.css' %}">
	<!--Datatables css-->
	<link rel="stylesheet" href="{% static 'DataTables-1.10.18/datatables.min.css' %}">
</head>
{% endblock %}
{% block content %}

<script src="{% static 'Highstock-7.1.2/code/highstock.js' %}"></script>
<script src="{% static 'Highstock-7.1.2/code/modules/exporting.js' %}"></script>
<script src="{% static 'jquery-loading-master/dist/jquery.loading.min.js' %}"></script>
<link rel="stylesheet"
	  href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
	  integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS"
	  crossorigin="anonymous">
<script
		src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
		integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
		crossorigin="anonymous"></script>
<!--Datatables Js-->
<script src="{% static 'DataTables-1.10.18/datatables.min.js' %}">
Highcharts.chart('container', {
    chart: {
        type: 'bar'
    },
    title: {
        text: 'Bidang pekerjaan alumni'
    },
    subtitle: {
        text: 'Source: <a href="" target="_blank">Internal Database</a>'
    },
    xAxis: {
        categories: [
			"Melalu Iklan Koran/Majalah Dan Brosur",
			"Melamar ke perusahaan tanpa mengetahui lowongan yang ada",
			"Pergi ke bursa/pameran kerja",
			"Mencari lewat internet/iklan online/milis",
			"Dihubungi oleh perusahaan",
			"Menghubungi Kemenakertrans",
			"Menghubungi agen tenaga kerja komersial/swasta",
			"Memeroleh informasi dari pusat/kantor pengembangan karir fakultas/universitas",
            "Menghubungi kantor kemahasiswaan/hubungan alumni",
            "Membangun jejaring (network) sejak masih kuliah",
            "Melalui relasi (misalnya dosen, orang tua, saudara, teman, dll.)",
            "Membangun bisnis sendiri",
			"Melalui penempatan kerja atau magang",
            "Bekerja di tempat yang sama dengan tempat kerja semasa kuliah",
            "Lainnya"
        ],
        title: {
            text: null
        },
        max:4,
        scrollbar: {
            enabled: true
        },
    },
    yAxis: {
        title: {
            text: 'Jumlah Alumni'
        },
        labels: {
            overflow: 'justify'
        }
    },
    tooltip: {
        valueSuffix: ' Alumni'
    },
    plotOptions: {
        bar: {
            dataLabels: {
                enabled: true,
                format: '{point.y:f} Alumni'
            }
        }
    },
    series: [
    {
        name: 'Jumlah Alumni',
		cursor: 'pointer',
        data: [
			{% for i in data %}
				{
					y: {{ i.0 }},
					events: {
					click: function() {
	    					table.destroy();
                            $("#content").html("");
                            urls = "{% url 'fill' i.1 2 %}";
                            fill({{ i.1 }},urls);
						}
					}
				},
				{% endfor %}
        ]
    }
    ]
});
function fill(filter,urls){
	$('#container').loading();
    $.ajax({
    url: urls,
    type: 'POST',
    dataType: 'JSON',
    data: {
        'csrfmiddlewaretoken': '{{ csrf_token }}',
        'filter': filter,
     }
    })
    .done(function(response){
    $.each(response, function(key, value){
        var tr = document.createElement("TR");
        tr.setAttribute("id",value.nim);
        document.getElementById("content").appendChild(tr);
        var list = [
                value.nim,
                value.nama,
                value.th_lulus,
                value.tmp_lhr,
                value.tgl_lhr,
                value.alamat
            ];
        var x;
        for (x of list){
            var td = document.createElement("TD");
            var text = document.createTextNode(x);
            td.appendChild(text);
            document.getElementById(value.nim).appendChild(td);
        }
    });
    table = $('#table_id').DataTable();
    $('#container').loading('stop');
    $('#practiseModal').modal('show');
    });
}
</script>
</body>
{% endblock %}